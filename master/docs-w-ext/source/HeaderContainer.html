<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='Ext-grid-locking-HeaderContainer'>/**
</span> * Private class which acts as a HeaderContainer for the Lockable which aggregates all columns
 * from both sides of the Lockable. It is never rendered, it's just used to interrogate the
 * column collection.
 * @private
 */
Ext.define('Ext.grid.locking.HeaderContainer', {
    extend: 'Ext.grid.header.Container',
    requires: [
        'Ext.grid.ColumnManager'
    ],

<span id='Ext-grid-locking-HeaderContainer-property-headerCtRelayEvents'>    headerCtRelayEvents: [
</span>        &quot;blur&quot;,
        &quot;focus&quot;,
        &quot;move&quot;,
        &quot;resize&quot;,
        &quot;destroy&quot;,
        &quot;beforedestroy&quot;,
        &quot;boxready&quot;,
        &quot;afterrender&quot;,
        &quot;render&quot;,
        &quot;beforerender&quot;,
        &quot;removed&quot;,
        &quot;hide&quot;,
        &quot;beforehide&quot;,
        &quot;show&quot;,
        &quot;beforeshow&quot;,
        &quot;enable&quot;,
        &quot;disable&quot;,
        &quot;added&quot;,
        &quot;deactivate&quot;,
        &quot;beforedeactivate&quot;,
        &quot;activate&quot;,
        &quot;beforeactivate&quot;,
        &quot;remove&quot;,
        &quot;add&quot;,
        &quot;beforeremove&quot;,
        &quot;beforeadd&quot;,
        &quot;afterlayout&quot;,
        &quot;menucreate&quot;,
        &quot;sortchange&quot;,
        &quot;columnschanged&quot;,
        &quot;columnshow&quot;,
        &quot;columnhide&quot;,
        &quot;columnmove&quot;,
        &quot;headertriggerclick&quot;,
        &quot;headercontextmenu&quot;,
        &quot;headerclick&quot;,
        &quot;columnresize&quot;,
        &quot;statesave&quot;,
        &quot;beforestatesave&quot;,
        &quot;staterestore&quot;,
        &quot;beforestaterestore&quot;
    ],

<span id='Ext-grid-locking-HeaderContainer-method-constructor'>    constructor: function(lockable) {
</span>        var me = this,
            lockedGrid = lockable.lockedGrid,
            normalGrid = lockable.normalGrid;

        me.lockable = lockable;
        me.callParent();

        // Create the unified column manager for the lockable grid assembly
        lockedGrid.visibleColumnManager.rootColumns =
            normalGrid.visibleColumnManager.rootColumns =
            lockable.visibleColumnManager =
            me.visibleColumnManager = new Ext.grid.ColumnManager(true, lockedGrid.headerCt, normalGrid.headerCt);
            
        lockedGrid.columnManager.rootColumns =
            normalGrid.columnManager.rootColumns =
            lockable.columnManager =
            me.columnManager = new Ext.grid.ColumnManager(false, lockedGrid.headerCt, normalGrid.headerCt);

        // Relay *all* events from the two HeaderContainers
        me.lockedEventRelayers = me.relayEvents(lockedGrid.headerCt, me.headerCtRelayEvents);
        me.normalEventRelayers = me.relayEvents(normalGrid.headerCt, me.headerCtRelayEvents);
    },
    
<span id='Ext-grid-locking-HeaderContainer-method-destroy'>    destroy: function() {
</span>        var me = this;
        
        Ext.destroy(me.lockedEventRelayers, me.normalEventRelayers);
        me.lockedEventRelayers = me.normalEventRelayers = null;
        
        me.callParent();
    },

<span id='Ext-grid-locking-HeaderContainer-method-getRefItems'>    getRefItems: function() {
</span>        return this.lockable.lockedGrid.headerCt.getRefItems().concat(this.lockable.normalGrid.headerCt.getRefItems());
    },

<span id='Ext-grid-locking-HeaderContainer-method-getGridColumns'>    // This is the function which all other column access methods are based upon
</span>    // Return the full column set for the whole Lockable assembly
    getGridColumns: function() {
        return this.lockable.lockedGrid.headerCt.getGridColumns().concat(this.lockable.normalGrid.headerCt.getGridColumns());
    },

<span id='Ext-grid-locking-HeaderContainer-method-getColumnsState'>    // Lockable uses its headerCt to gather column state
</span>    getColumnsState: function () {
        var me = this,
            locked = me.lockable.lockedGrid.headerCt.getColumnsState(),
            normal = me.lockable.normalGrid.headerCt.getColumnsState();

        return locked.concat(normal);
    },

<span id='Ext-grid-locking-HeaderContainer-method-applyColumnsState'>    // Lockable uses its headerCt to apply column state
</span>    applyColumnsState: function (columns) {
        var me             = this,
            lockedGrid     = me.lockable.lockedGrid,
            lockedHeaderCt = lockedGrid.headerCt,
            normalHeaderCt = me.lockable.normalGrid.headerCt,
            lockedCols     = Ext.Array.toValueMap(lockedHeaderCt.items.items, 'stateId'),
            normalCols     = Ext.Array.toValueMap(normalHeaderCt.items.items, 'stateId'),
            locked         = [],
            normal         = [],
            lockedWidth    = 1,
            length         = columns.length,
            i, existing,
            lockedDefault,
            col;

        for (i = 0; i &lt; length; i++) {
            col = columns[i];

            lockedDefault = lockedCols[col.id];
            existing = lockedDefault || normalCols[col.id];

            if (existing) {
                if (existing.applyColumnState) {
                    existing.applyColumnState(col);
                }
                if (existing.locked === undefined) {
                    existing.locked = !!lockedDefault;
                }
                if (existing.locked) {
                    locked.push(existing);
                    if (!existing.hidden &amp;&amp; typeof existing.width === 'number') {
                        lockedWidth += existing.width;
                    }
                } else {
                    normal.push(existing);
                }
            }
        }

        // state and config must have the same columns (compare counts for now):
        if (locked.length + normal.length === lockedHeaderCt.items.getCount() + normalHeaderCt.items.getCount()) {
            lockedHeaderCt.removeAll(false);
            normalHeaderCt.removeAll(false);

            lockedHeaderCt.add(locked);
            normalHeaderCt.add(normal);

            lockedGrid.setWidth(lockedWidth);
        }
    },

<span id='Ext-grid-locking-HeaderContainer-method-disable'>    disable: function() {
</span>        var topGrid = this.lockable;

        topGrid.lockedGrid.headerCt.disable();
        topGrid.normalGrid.headerCt.disable();
    },

<span id='Ext-grid-locking-HeaderContainer-method-enable'>    enable: function() {
</span>        var topGrid = this.lockable;

        topGrid.lockedGrid.headerCt.enable();
        topGrid.normalGrid.headerCt.enable();
    }
});
</pre>
</body>
</html>
